# **SARS-CoV-2 Viral Genomics Analysis Pipeline**

This pipeline covers quality control, read alignment, BAM processing and variant calling using standard bioinformatics tools for analysing COVID-19 viral sequencing data (ERR5743893) against the SARS-CoV-2 reference genome (MN908947).

# **Tool Explanations**
## **1. FastQC**

**Purpose:** Generates quality control reports for raw sequencing reads, assessing per-base quality, GC content, sequence duplication, and adapter contamination.

- Essential first step to identify data issues before downstream analysis

- Produces HTML reports with summary statistics and graphs​

## **2. BWA (Burrows-Wheeler Aligner)**

**Purpose:** Aligns short sequencing reads to a reference genome using the BWA-MEM algorithm optimized for Illumina paired-end reads.

- Handles mismatches, gaps, and complex mapping scenarios efficiently

- Outputs SAM format with alignment coordinates and mapping quality scores​

## **3. Samtools(Software Asset Management Tools)**

**Purpose:** Suite of utilities for manipulating SAM/BAM files and reference genomes.

- Converts formats (SAM↔BAM), sorts alignments, indexes files for fast access

- faidx creates random access indexes for FASTA files used in variant calling​

## **4. Freebayes**

**Purpose:** Haplotype-based variant caller for discovering SNPs and indels from BAM alignments.

- Population genetics model considers allele frequencies and mapping quality

- Installed via Bioconda for compatibility with bioinformatics environments.

## **5. BCFtools** 

**Purpose:** High-performance toolkit for manipulation and analysis of VCF/BCF variant files.

- Filters variants by quality, depth, allele frequency (bcftools view -i 'QUAL>20')

- Merges multiple VCFs, generates summaries, and performs statistical analysis

- Essential for post-variant calling processing and quality control of Freebayes output

# **SARS-CoV-2 Viral Genomics Analysis Pipeline**
## **1. Environment Setup**

Update system and install Ubuntu packages
    
    sudo apt update & sudo apt upgrade
    sudo apt install fastqc bwa samtools bcftools vcftools

Install Freebayes via conda (bioconda channel)
    
    conda install -c bioconda freebayes
    freebayes --version  # Verify installation

**Note:** Bioconda provides pre-compiled bioinformatics software with dependency management.

## **2. Data Organization**

Create directories for Raw sequencing data, Output files, Documentation and Script

    mkdir Raw_Data Documentation Outputs Script

## **3. Data Download**

Download paired-end COVID-19 sequencing fastq files from the European Nucleotide Archive (ENA):

    cd Raw_Data/
    wget -nc ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR574/003/ERR5743893/ERR5743893_1.fastq.gz
    wget -nc ftp://ftp.sra.ebi.ac.uk/vol1/fastq/ERR574/003/ERR5743893/ERR5743893_2.fastq.gz

Download the SARS-CoV-2 reference genome in FASTA format:

    wget "https://www.ebi.ac.uk/ena/browser/api/fasta/MN908947.3?download=true" -O MN908947.fasta

## **4. Quality Control**

Perform quality check of raw fastq files with FastQC:

    fastqc ./Raw_Data/ERR5743893_1.fastq.gz ./Raw_Data/ERR5743893_2.fastq.gz --outdir ./Outputs/

## **5. Data Processing and Alignment**

Decompress FASTQ files:

    gunzip ./Raw_Data/ERR5743893_1.fastq.gz ./Raw_Data/ERR5743893_2.fastq.gz

Index reference genome (creates MN908947.*.bwt files):
    
    cd Outputs/
    bwa index -p MN908947 ../Raw_Data/MN908947.fasta

Align reads to reference (produces SAM file):
    
    bwa mem MN908947 ../Raw_Data/ERR5743893_1.fastq ../Raw_Data/ERR5743893_2.fastq > ERR5743893.sam


## **6. BAM File Processing**

Convert SAM to compressed BAM (-@ 20 uses 20 threads):

    samtools view -@ 20 -S -b ERR5743893.sam > ERR5743893.bam

Sort the BAM file (-@ 4 uses 4 threads):

    samtools sort -@ 4 -o ERR5743893.sorted.bam ERR5743893.bam

Index the sorted BAM file for fast region queries:

    samtools index ERR5743893.sorted.bam

Create FASTA index of the reference genome for variant calling:

    samtools faidx ../Raw_Data/MN908947.fasta

## **7. Variant Calling**

    freebayes -f ../Raw_Data/MN908947.fasta ERR5743893.sorted.bam > ERR5743893.vcf

# **Output:** 

VCF file containing discovered variants (SNPs/indels) with quality scores and allele frequencies.

**Notes:**

- The -@ in samtools commands specifies the number of threads.

- The -nc option in wget prevents re-downloading files if already present.

- Output files are stored in the Outputs directory for organization.

